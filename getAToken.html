<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Callback - Ottieni il Token</title>
</head>
<body>
    <h1>Autenticazione Completata</h1>
    <p>Premi il pulsante qui sotto per copiare il token negli appunti.</p>

    <button id="copyTokenButton">Copia Token</button>
    <p id="statusMessage"></p>

    <script>
        // Estrarre il token dall'URL (in caso sia presente come hash)
        const params = new URLSearchParams(window.location.hash.substring(1));
        const token = params.get("access_token");

        if (token) {
            // Mostra un messaggio che il token è stato trovato
            document.getElementById("statusMessage").textContent = "Token trovato! Premi il pulsante per copiarlo.";
            
            document.getElementById("copyTokenButton").addEventListener("click", () => {
                // Copia il token negli appunti
                navigator.clipboard.writeText(token).then(() => {
                    document.getElementById("statusMessage").textContent = "Token copiato negli appunti!";
                }).catch(err => {
                    document.getElementById("statusMessage").textContent = "Errore nel copiare il token: " + err;
                });
            });
        } else {
            // Se il token non è presente nell'URL, mostra un messaggio di errore
            document.getElementById("statusMessage").textContent = "Token non trovato nell'URL. Riprova l'autenticazione.";
            document.getElementById("copyTokenButton").style.display = "none"; // Nasconde il pulsante
        }
    </script>
</body>
</html>
